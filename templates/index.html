{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Статьи</h1>

{% if posts %}
    {% for post in posts %}
    <div class="card card-preview mb-3">
        <div class="card-body py-3">
            <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0 preview-title">{{ post.title }}</h5>
                <small class="text-muted flex-shrink-0 ms-2">{{ post.date_posted.strftime('%d.%m.%Y') }}</small>
            </div>

            <div class="preview-content mb-2">
                {{ post.content | excerpt(200) | markdown | safe }}
            </div>

            <div class="d-flex justify-content-between align-items-center">
                <a href="{{ url_for('post', post_id=post.id) }}" class="btn btn-outline-primary btn-sm">Читать далее</a>
                {% if post.date_updated %}
                <small class="text-muted" title="Обновлено: {{ post.date_updated.strftime('%d.%m.%Y %H:%M') }}">изм.</small>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="text-center py-5">
        <div class="mb-4">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="text-muted mx-auto">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
        </div>
        <p class="text-muted mb-4">Статей пока нет.</p>
        {% if current_user.is_authenticated %}
            {% if current_user.is_active %}
                <a href="{{ url_for('create_post') }}" class="btn btn-primary">Создать первую статью</a>
            {% else %}
                <div class="alert alert-warning">
                    <p class="mb-0">Пожалуйста, подтвердите ваш email перед созданием статей.</p>
                </div>
            {% endif %}
        {% else %}
            <a href="{{ url_for('register') }}" class="btn btn-primary">Зарегистрироваться</a>
        {% endif %}
    </div>
{% endif %}
{% endblock %}